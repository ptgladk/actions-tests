name: Test CI/CD pipeline
on:
  push:
  workflow_dispatch:
jobs:
  tests:
    runs-on: ubuntu-latest
    steps:
      - run: echo "testing..."

  build:
    needs: tests
    runs-on: ubuntu-latest
    steps:
      - run: echo "building..."

  staging:
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: Staging
    steps:
      - run: echo "deploy to staging..."

  production:
    needs: staging
    runs-on: ubuntu-latest
    environment:
      name: Production
    steps:
      - uses: trstringer/manual-approval@v1
        with:
          secret: ${{ github.token }}
          approvers: ptgladk
          minimum-approvals: 1
      - run: echo "deploy to production..."
